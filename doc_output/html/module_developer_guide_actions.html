<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Xataface: Creating a Module With an Action</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xataface-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Xataface
   &#160;<span id="projectnumber">2.0alpha2</span>
   </div>
   <div id="projectbrief">Xataface Application Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Creating a Module With an Action </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>Return to <a class="el" href="module_developer_guide.html">Module Developer's Guide</a></li>
<li>Previous: <a class="el" href="module_developer_guide_first_module.html">Creating Your First Module</a></li>
<li>Next: <a class="el" href="module_developer_guide_javascript.html">Adding Custom Javascripts</a></li>
</ul>
<p>In the <a class="el" href="module_developer_guide_first_module.html">last section</a> we developed a simple module that displays "Hello World" at the top of every page.</p>
<p>In this tutorial we'll create our own custom action that can called from any application that includes our module.</p>
<dl class="section attention"><dt>Attention</dt><dd>This tutorial assumes a familiarity with actions. For more information about Xataface actions please refer to <a href="http://xataface.com/documentation/tutorial/getting_started/dataface_actions">Xataface Actions the Basics</a>.</dd></dl>
<dl class="section user"><dt>Step 1 Create an <code>actions</code> directory</dt><dd></dd></dl>
<p>We start out by creating a directory for the actions of our module. The directory will be located at:</p>
<div class="fragment"><div class="line">/var/www/myapp/modules/hello_world/actions</div>
</div><!-- fragment --><dl class="section user"><dt>Step 2 Create a PHP file for our Action</dt><dd></dd></dl>
<p>We'll call our action @ hello_world, so the PHP file will be located at <code>actions/hello_world.php</code> </p>
<p>Inside this file we'll create a basic action handler that simply displays "hello world":</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>actions_hello_world {</div>
<div class="line">        <span class="keyword">function</span> handle($params){</div>
<div class="line">                echo <span class="stringliteral">&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See Also</dt><dd><a class="el" href="interface_action_handler.html">ActionHandler</a> for details about the structure of an action handler.</dd></dl>
<dl class="section user"><dt>Step 3 Test Our Action</dt><dd></dd></dl>
<p>In your browser point to the URL <code>path/to/myapp/index.php</code>?-action=hello_world</p>
<p>You should see something like</p>
<div class="image">
<img src="http://media.weblite.ca/files/photos/Screen_shot_2011-11-28_at_1.34.48_PM.png?max_width=640" />
</div>
<p>Notice that our action uses a blank screen and just displays "Hello World". It doesn't use the Xataface look and feel for the rest of the app. It also, noticeably, doesn't include the "Hello World" header defined in our <code>block__before_header</code> slot (from <a class="el" href="module_developer_guide_first_module.html">Creating Your First Module</a>). This is because we aren't using any templates to render the page. We're just doing direct output with the <code>echo</code> command.</p>
<h1><a class="anchor" id="module_developer_guide_templates"></a>
Using Templates</h1>
<p>Right now our hello world action doesn't make use of any templates so it's quite plain. We could provide a template in our application's <code>templates</code> directory and then reference it in our action using the df_display() function, but this wouldn't be good practice because it would make our module less portable (because not all applications would have our template). What we would prefer to do is to package the templates with the module.</p>
<dl class="section user"><dt>Packaging Templates With the Module</dt><dd></dd></dl>
<p>Packaging templates with a module is easy. You just create a <code>templates</code> directory inside the module directory, then you just need to progammatically register this directory with Xataface's skin tool before you use it.</p>
<dl class="section user"><dt>Step 1 Creating the <code>templates</code> directory</dt><dd></dd></dl>
<p>Create a directory inside the <code>hello_world</code> module directory named <code>templates</code> i.e. </p>
<div class="fragment"><div class="line">modules/hello_world/templates</div>
</div><!-- fragment --><dl class="section user"><dt>Step 2 Create a template</dt><dd></dd></dl>
<p>We are going to create a template for our <code>hello_world</code> action that extends from the <code>Dataface_Main_Template.html</code> template (the main Xataface template). So we create a template named <code>hello_world_template.html</code> inside the <code>templates</code> directory. i.e. </p>
<div class="fragment"><div class="line">modules/hello_world/templates/hello_world_template.html</div>
</div><!-- fragment --><p>with the following contents:</p>
<div class="fragment"><div class="line">{use_macro file=<span class="stringliteral">&quot;Dataface_Main_Template.html&quot;</span>}</div>
<div class="line">    {fill_slot name=<span class="stringliteral">&quot;main_section&quot;</span>}</div>
<div class="line">        </div>
<div class="line">        &lt;h1&gt;Hello world&lt;/h1&gt;</div>
<div class="line">    </div>
<div class="line">    {/fill_slot}</div>
<div class="line">{/use_macro}</div>
</div><!-- fragment --><dl class="section user"><dt>Step 3 Register the <code>templates</code> directory</dt><dd></dd></dl>
<p>Before we can use our template from our <code>hello_world</code> action, we need to register our custom <code>templates</code> directory with the <a class="el" href="class_dataface___skin_tool.html">Dataface_SkinTool</a> so that it knows the look for templates there. We can do this with the df_register_skin() function:</p>
<p>Then we'll use the df_display() function to display our template. After these changes, our hello_world.php action will look like:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>actions_hello_world {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">function</span> handle($params){</div>
<div class="line">        </div>
<div class="line">                df_register_skin(<span class="stringliteral">&#39;hello world skin&#39;</span>, dirname(__FILE__).<span class="stringliteral">&#39;/../templates&#39;</span>);</div>
<div class="line">                df_display(array(), <span class="stringliteral">&#39;hello_world_template.html&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section user"><dt>Step 4 Trying Our Action Again</dt><dd></dd></dl>
<p>Point the browser to the application again at <code>index.php</code>?-action=hello_world You should notice that the action is now rendered with the full Xataface look and feel.</p>
<div class="image">
<img src="http://media.weblite.ca/files/photos/Screen_shot_2011-11-28_at_1.51.34_PM.png?max_width=640" />
</div>
<h1><a class="anchor" id="module_developer_guide_best_practice"></a>
Best Practice - Namespaces</h1>
<p>Since all templates are loaded with the same namespace and are set up to override each other, it is a good practice to develop a unique directory structure under your <code>templates</code> directory so that you can uniquely identify your module's templates. The naming convention that is recommended is to place all templates in a directory structure as folows:</p>
<div class="fragment"><div class="line">templates/xataface/modules/%modulename%/%templatename%.html</div>
</div><!-- fragment --><p>Then when we are referring to the template with the df_display() method we would include the path starting from the  directory. In accordance with this convention let's change the location of our hello_world_temlate.html to be located at: </p>
<div class="fragment"><div class="line">templates/xataface/modules/hello_world/hello_world_template.html</div>
</div><!-- fragment --><p>And change the action as follows: </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>actions_hello_world {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">function</span> handle($params){</div>
<div class="line">        </div>
<div class="line">                df_register_skin(<span class="stringliteral">&#39;hello world skin&#39;</span>, dirname(__FILE__).<span class="stringliteral">&#39;/../templates&#39;</span>);</div>
<div class="line">                df_display(</div>
<div class="line">                    array(),</div>
<div class="line">                    <span class="stringliteral">&#39;xataface/modules/hello_world/hello_world_template.html&#39;</span></div>
<div class="line">                );</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>Return to <a class="el" href="module_developer_guide.html">Module Developer's Guide</a></li>
<li>Previous: <a class="el" href="module_developer_guide_first_module.html">Creating Your First Module</a></li>
<li>Next: <a class="el" href="module_developer_guide_javascript.html">Adding Custom Javascripts</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 22 2013 09:40:35 for Xataface by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
